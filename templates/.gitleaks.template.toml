# Generated by gimme-the-lint
# Gitleaks secret detection configuration
# https://github.com/gitleaks/gitleaks

title = "Secret Detection Configuration"

[extend]
useDefault = true

# Common API key patterns
[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-api03-[A-Za-z0-9_-]{95,105}'''
tags = ["api-key", "ai"]

[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''sk-[A-Za-z0-9]{20,50}'''
tags = ["api-key", "ai"]

[[rules]]
id = "google-api-key"
description = "Google API Key"
regex = '''AIza[0-9A-Za-z_-]{35}'''
tags = ["api-key", "google"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''(?i)(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["aws", "secret"]

[[rules]]
id = "jwt-secret"
description = "JWT Secret Key"
regex = '''(?i)(jwt.secret|secret.key|SECRET_KEY)\s*[:=]\s*['\"]?([A-Za-z0-9+/=]{32,})['\"]?'''
tags = ["jwt", "secret"]

[[rules]]
id = "database-url-password"
description = "Database URL with embedded password"
regex = '''(?i)(postgresql|postgres|mysql|mongodb)://[a-zA-Z0-9_-]+:([^@\s]+)@'''
tags = ["database", "password"]
secretGroup = 2

# Allowlist (false positive prevention)
[allowlist]
description = "Allowlist for false positives"

paths = [
    '''\.env\.example$''',
    '''\.env\.template$''',
    '''\.env\.sample$''',
    '''/examples/''',
    '''/templates/''',
    '''/test/fixtures/'''
]

regexes = [
    '''test-key''',
    '''fake-key''',
    '''example-key''',
    '''placeholder''',
    '''your-api-key-here''',
    '''sk-test-''',
    '''xxx+'''
]

stopwords = ["test", "example", "sample", "placeholder", "demo", "fake", "mock"]
